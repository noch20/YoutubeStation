<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Youtube Station</title>
        {% load static %}
        <link rel="stylesheet" type="text/css" href="{% static 'live/index.css' %}">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
    <body>
        <h1>YoutubeStationへようこそ</h1>
        <form>
            <!-- <label for="live_url">生放送のURL：</label> -->
            <input type="url" id="live_url" name="live_url" placeholder="生放送のURL">
            <input type="submit" name="Submit" value="解析する">
        </form>
    {% if live_url %}
        <div>
            <canvas id="chart"></canvas>
            <script>
                const labels = {{ chart_label }};
                const data = {
                labels: labels,
                datasets: [{
                    label: 'My First dataset',
                    backgroundColor: 'rgb(255, 99, 132)',
                    borderColor: 'rgb(255, 99, 132)',
                    data: {{ chart_data }},
                }]
                };
                const config = {
                    type: 'bar',
                    data,
                    options: {
                        scales: {
                            x: {
                                type: 'linear'
                            }
                        }
                    }
                }
                var chart = new Chart(
                    document.getElementById("chart"), config
                )
            </script>
        </div>

        <table id="ranking">
            <tr>
                <th>rank</th>
                <th>word</th>
                <th>count</th>
            </tr>
        </table>
        <script>
            var table = document.getElementById("ranking");

            {% for comment in comments %}
                var row = table.insertRow();
                
                var rank = row.insertCell();
                var word = row.insertCell();
                var count = row.insertCell();
                
                rank.innerHTML = {{ forloop.counter }};
                word.innerHTML = "{{ comment.0 }}";
                count.innerHTML = {{ comment.1 }};
            {% endfor %}
        </script>
    {% endif %}
    </body>
</html>